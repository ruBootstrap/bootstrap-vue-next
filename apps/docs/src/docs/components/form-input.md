# Поле ввода

<PageHeader>

Создавайте различные типы полей ввода, такие как: `text`, `password`, `number`, `url`, `email`, `search`, `range`, `date` и другие.

</PageHeader>

<<< DEMO ./demo/FormInputOverview.vue

## Тип поля ввода

`BFormInput` по умолчанию создаёт поле типа `text`, но вы можете задать пропс `type` как один из поддерживаемых HTML5-типов: `text`, `password`, `email`, `number`, `url`, `tel`, `search`, `date`, `datetime-local`, `month`, `week`, `time`, `range` или `color`.

<<< DEMO ./demo/FormInputTypes.vue

Если пропс `type` установлен в неподдерживаемое значение (см. выше), будет отрисовано поле типа `text`, а в консоль будет выведено предупреждение.

::: warning
**Особенности различных типов полей:**

- Не все браузеры поддерживают все типы полей, и некоторые типы могут отображаться по-разному в разных браузерах и версиях. См. [Can I use](https://caniuse.com/?search=input)
- Браузеры, не поддерживающие определённый тип, вернутся к типу `text` (даже если в разметке будет указан нужный тип)
- Не выполняется проверка поддержки типа поля браузером
- Chrome потерял поддержку `datetime` в версии 26, Opera — в 15, а Safari на iOS 7. Вместо устаревшего `datetime` используйте два отдельных поля: `date` и `time`
- `date` и `time` — это нативные типы браузера, а не кастомные пикеры
- Для полей типа дата/время отображаемое значение может отличаться от возвращаемого (например, порядок год-месяц-день)
- Независимо от типа поля, значение **всегда** возвращается как строка
- `v-model.lazy` не поддерживается в `BFormInput` (и других кастомных компонентах Vue). Используйте вместо этого пропс `lazy`
- В старых версиях Firefox `readonly` может не поддерживаться для полей типа `range`
- Для типов, не поддерживающих `min`, `max` и `step` (`text`, `password`, `tel`, `email`, `url` и др.), эти значения будут проигнорированы (но останутся в разметке)

**Особенности автозаполнения и ввода через IME:**

- При использовании автоподсказок v-model обновится только после выбора слова (или ввода пробела). Если слово не выбрано, v-model обновится при потере фокуса с текущим текстом
- При вводе через IME (например, китайский, японский и др.) v-model обновится только после завершения ввода
  :::

### Поле типа range

Поля с типом `range` используют класс Bootstrap v5 `.form-range`. Трек (фон) и ползунок стилизованы одинаково во всех браузерах.

Для range по умолчанию значения `min` и `max` равны `0` и `100`. Вы можете изменить их с помощью пропсов `min` и `max`.

<<< DEMO ./demo/FormInputRange.vue

По умолчанию range «прыгает» по целым значениям. Чтобы изменить это, задайте значение пропса `step`. В примере ниже шаг — 0.5.

<<< DEMO ./demo/FormInputRangeStep.vue

::: info NOTE
Поля типа range (как и все остальные) возвращают значение как строку. Для получения числа используйте `Number(value)`, `parseInt(value, 10)`, `parseFloat(value)` или пропс `number`.
:::

## Размеры поля

Задайте высоту с помощью пропса `size`: `sm` или `lg` для маленького или большого размера соответственно.

Для управления шириной поместите поле в стандартную колонку Bootstrap.

<<< DEMO ./demo/FormInputSize.vue#template{vue-html}

::: info NOTE
Тип `range` не поддерживает изменение размера. Если поле находится внутри `BInputGroup` с заданным пропсом `size`, связанные элементы будут изменять размер, но range останется прежним.

Атрибут HTML `<input size>` (ширина в символах) не поддерживается. Используйте стили, утилитарные классы или сетку (`BRow`, `BCol`) для задания ширины.
:::

## Контекстные состояния

Bootstrap поддерживает стили валидации для состояний `valid` и `invalid` для большинства элементов формы.

Обычно рекомендуется использовать определённое состояние для разных типов обратной связи:

- `false` (некорректное состояние) — для обязательных или блокирующих полей. Пользователь должен корректно заполнить это поле для отправки формы
- `true` (корректное состояние) — для поэтапной валидации, чтобы поощрять пользователя при заполнении формы
- `null` — не отображает состояние валидации

Чтобы применить одну из иконок состояния к `BFormInput`, установите пропс `state` в `false` (некорректно), `true` (корректно) или `null` (без состояния).

<<< DEMO ./demo/FormInputState.vue#template{vue-html}

## Живой пример

<<< DEMO ./demo/FormInputStateLive.vue

::: info TIP
Используйте компонент [`BFormGroup`](/docs/components/form-group) для автоматической генерации разметки, как выше.
:::

## Передача состояния вспомогательным технологиям и людям с дальтонизмом

Использование только цветовой индикации состояния не даст информации пользователям вспомогательных технологий (например, экранных читалок) и людям с дальтонизмом.

Обеспечьте альтернативную индикацию состояния. Например, добавьте подсказку в текст метки или отдельный блок с пояснением.

Для вспомогательных технологий некорректным полям можно добавить атрибут `aria-invalid="true"`.

Если у `BFormInput` некорректное состояние (`state` равен `false`), рекомендуется также установить пропс `aria-invalid` в `true` или одно из поддерживаемых значений:

- `false`: Ошибок не обнаружено (по умолчанию)
- `true` (или `'true'`): Значение не прошло валидацию
- `'grammar'`: Обнаружена грамматическая ошибка
- `'spelling'`: Обнаружена орфографическая ошибка

Если `aria-invalid` не задан явно, а `state` равен `false`, то атрибут `aria-invalid` будет автоматически установлен в `'true'`.

## Поддержка форматирования

`BFormInput` поддерживает форматирование значения через функцию, переданную в пропс `formatter`.

Форматирование (если функция задана) происходит при срабатывании событий `input` и `change`. Можно ограничить форматирование только событием `blur`, установив булевый пропс `lazy-formatter`.

Функция `formatter` получает два аргумента: исходное значение поля и объект события (если есть).

Функция должна возвращать отформатированное значение в виде _строки_.

Если функция не задана, форматирование не выполняется.

<<< DEMO ./demo/FormInputFormatter.vue

::: info NOTE
Если используете не текстовые типы (`color`, `range`, `date`, `number`, `email` и др.), убедитесь, что функция возвращает значение в нужном формате (`date` -> '2000-06-01', `color` -> '#ff0000' и т.д.) для данного типа. Функция **обязательно** должна возвращать строку.

При не ленивом форматировании, если курсор не в конце значения, он может перескочить в конец после ввода символа. Используйте объект события и `event.target` для управления положением курсора. Это остаётся на усмотрение разработчика.
:::

## Только для чтения (plain text)

Если вы хотите, чтобы `<BFormInput readonly>` отображался как обычный текст, установите пропс `plaintext` (не обязательно указывать `readonly`). Это уберёт стандартное оформление поля и сохранит правильные отступы.

Опция `plaintext` не поддерживается для типов `color` и `range`.

## Отключение событий прокрутки мыши для числовых полей

<NotYetImplemented/>

## Поддержка datalist

Datalist — это нативный HTML-тег `<datalist>`, содержащий список `<option>`. Присвоив тегу datalist id, вы можете связать его с текстовым полем через атрибут `list`.

Это даёт полю поведение комбобокса или автодополнения: можно выбрать существующее значение или ввести новое.

<<< DEMO ./demo/FormInputDatalist.vue

В примере выше — «нативная» реализация datalist. BootstrapVueNext предоставляет вспомогательный компонент [`<BFormDatalist>`](/docs/components/form/#datalist-helper) для быстрого создания `<datalist>` из массива опций по тому же принципу, что и [`<BFormSelect>`](/docs/components/form-select#options-property).

**Примечания:**

- Datalist работает вместе с автозаполнением браузера: сначала показываются опции datalist, затем автозаполнение. Чтобы показывались только опции datalist, установите `autocomplete="off"` на `<BFormInput>`.
- Datalist **нельзя** использовать с типами `password`, `range` или `color`.
- Не все браузеры полностью поддерживают `<datalist>`, возможны баги. Рекомендуется рассматривать datalist как улучшение, а не как обязательную функцию. См. [Can I use](https://caniuse.com/datalist) для проверки поддержки. В частности, браузеры на Chromium показывают и текст, и значение объекта в списке опций.

## Модификаторы v-model

Поддерживаются нативные модификаторы [`trim`, `lazy`, и `number`](https://vuejs.org/guide/essentials/forms.html#modifiers). Они работают так же, как описано в документации Vue.js, поэтому отдельные свойства `trim`, `lazy` или `number` (как в BSV) больше не нужны.

## Поддержка debounce

В качестве альтернативы пропсу `lazy` `<BFormInput>` поддерживает debounce: обновление `v-model` происходит после паузы между вводом символов (или событием `change`). Если пользователь вводит новый символ (или удаляет), таймер сбрасывается.

Чтобы включить debounce, установите пропс `debounce` в любое целое число больше нуля (миллисекунды). Значение `0` отключает debounce.

::: info NOTE
Debounce **не** работает, если установлен пропс `lazy`.
:::

<<< DEMO ./demo/FormInputDatalist.vue

## Автофокус

Если установлен пропс `autofocus`, поле будет автоматически в фокусе при вставке (монтировании) в документ или повторной активации внутри компонента Vue `KeepAlive`. Обратите внимание: этот пропс **не** устанавливает атрибут `autofocus` на поле и не отслеживает его появление.

## Нативные и кастомные события

Поддерживаются все нативные события без необходимости использовать модификатор `.native`.

См. [руководство по миграции](/docs/migration-guide#bform-components) для изменений в обработке событий `change` и `input` по сравнению с bootstrap-vue.

## Доступ к нативному элементу

`BFormInput` предоставляет доступ к нативному элементу input ([HTMLInputElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement)) через ссылку с именем `element`. Вы можете использовать эту ссылку для доступа к свойствам и методам элемента.

Например: `<BFormInput ref="foo" ... />`, `const foo = ref<InstanceType<typeof BFormInput> | null>(null)`, затем
`foo?.value?.element?.methodName` или `foo?.value?.element?.propertyName`

### Свойства поля

| Свойство              | Примечание    |
| --------------------- | ------------- |
| `.selectionStart`     | Чтение/Запись |
| `.selectionEnd`       | Чтение/Запись |
| `.selectionDirection` | Чтение/Запись |
| `.validity`           | Только чтение |
| `.validationMessage`  | Только чтение |
| `.willValidate`       | Только чтение |

### Методы поля ввода

| Метод                  | Примечание                                 |
| ---------------------- | ------------------------------------------ |
| `.focus()`             | Установить фокус на поле                   |
| `.blur()`              | Снять фокус с поля                         |
| `.select()`            | Выделить весь текст в поле                 |
| `.setSelectionRange()` | Установить диапазон выделения текста       |
| `.setRangeText()`      | Заменить часть текста в поле               |
| `.setCustomValidity()` | Установить собственное сообщение валидации |
| `.checkValidity()`     | Проверить валидность поля                  |
| `.reportValidity()`    | Показать сообщение о валидности            |

Подробнее о свойствах и методах см. в [HTMLInputElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement). Поддержка зависит от типа поля.

`BFormInput` также предоставляет два метода компонента: `focus` и `blur`.

Например, с тем же setup, вызовите `foo?.value?.element?.focus`, чтобы установить фокус на элементе ввода.

<<< DEMO ./demo/FormInputMethods.vue

<ComponentReference :data="data" />

<script setup lang="ts">
import {data} from '../../data/components/formInput.data'
</script>
